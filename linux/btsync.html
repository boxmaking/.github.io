<!DOCTYPE html>
<html lang="zh-CN">
<head>
<!-- 2020-07-15 Wed 21:48 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>btsync相关</title>
<meta name="generator" content="Org mode">
<meta name="author" content="pengshao">
<meta name="keywords" content="btsync">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../css/org.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../index.html"> UP </a>
 |
 <a accesskey="H" href="../index.html"> HOME </a>
</div><div id="content">
<header>
<h1 class="title">btsync相关</h1>
</header><nav id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org0bd0030">1. 上安装Resilio Sync（BTSync）的方法</a></li>
<li><a href="#orgf33504f">2. 启动</a></li>
<li><a href="#orgc5ee6e6">3. 使用</a></li>
<li><a href="#org5af6e79">4. 设置Resilio Sync Web UI</a></li>
<li><a href="#orgfc043e8">5. 与其他设备共享文件夹及从其他设备接收文件夹</a></li>
</ul>
</div>
</nav>



<div id="outline-container-org0bd0030" class="outline-2">
<h2 id="org0bd0030"><span class="section-number-2">1</span> 上安装Resilio Sync（BTSync）的方法</h2>
<div class="outline-text-2" id="text-1">
<p>
我直接下载的deb安装包,dpkg-i安装的.
</p>
</div>
</div>

<div id="outline-container-orgf33504f" class="outline-2">
<h2 id="orgf33504f"><span class="section-number-2">2</span> 启动</h2>
<div class="outline-text-2" id="text-2">
<p>
安装后，Resilio Sync将自动启动，可以通过以下方式检查其状态：
</p>
<div class="org-src-container">
<pre class="src src-shell">$<span style="color: #912cee; background-color: #dcdcdc;">systemctl</span> status resilio-sync
</pre>
</div>


<p>
如果它没有运行，你可以用以下命令启动它：
</p>
<div class="org-src-container">
<pre class="src src-shell">$<span style="color: #912cee; background-color: #dcdcdc;">sudo</span> systemctl start resilio-sync
</pre>
</div>


<p>
默认情况下，Resilio Sync不会在启动时启动，可以启用自动启动：
</p>
<div class="org-src-container">
<pre class="src src-shell">$<span style="color: #912cee; background-color: #dcdcdc;">sudo</span> systemctl enable resilio-sync
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc5ee6e6" class="outline-2">
<h2 id="orgc5ee6e6"><span class="section-number-2">3</span> 使用</h2>
<div class="outline-text-2" id="text-3">
<p>
Resilio Sync作为rslsync用户运行
Web UI按照/etc/resilio-sync/config.json配置文件中
指定侦听127.0.0.1:8888
</p>
</div>
</div>



<div id="outline-container-org5af6e79" class="outline-2">
<h2 id="org5af6e79"><span class="section-number-2">4</span> 设置Resilio Sync Web UI</h2>
<div class="outline-text-2" id="text-4">
<p>
Linux版本的Resilio Sync不提供桌面客户端，相反，需要通过Web界面配置内容，在Web浏览器地址栏中键入以下内容以访问Resilio Sync Web UI：
</p>

<p>
127.0.0.1:8888
</p>

<p>
如果在远程Linux服务器上安装Resilio Sync，则需要使用Nginx或Apache设置反向代理以访问Web UI。
</p>

<p>
系统将要求你设置用户名和密码以保护Web UI：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
然后选择设备名称并单击Get started：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
并输入你刚刚创建的用户名和密码：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
登录后，你可以将计算机上的文件夹共享给其他设备或从其他设备接收文件夹。
</p>
</div>
</div>



<div id="outline-container-orgfc043e8" class="outline-2">
<h2 id="orgfc043e8"><span class="section-number-2">5</span> 与其他设备共享文件夹及从其他设备接收文件夹</h2>
<div class="outline-text-2" id="text-5">
<p>
1、与其他设备共享文件夹
</p>

<p>
要在计算机上共享文件夹，请单击左上角的+按钮，然后选择标准文件夹：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
然后选择计算机上的文件夹：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
可能会遇到以下错误消息：
</p>

<p>
Can't open the destination folder.
</p>

<p>
或者：Don't have permissions to write to selected folder.
</p>

<p>
这是因为Resilio Sync作为rslsync用户运行，后者无权访问该文件夹。
</p>

<p>
假设你选择了您的主文件夹/home/your-username/作为共享文件夹，要解决上述错误，你需要做的就是使用以下命令将主文件夹的权限授予rslsync用户：
</p>

<p>
sudo setfacl -R -m "u:rslsync:rwx" /home/your-username
</p>

<p>
以上命令不会更改共享文件夹的所有者，所有者拥有与往常相同的权限，它的作用是为另一个用户授予读，写和执行权限，即rslsync，请注意，-R（递归）标志必须位于-m（修改）标志之前，紧接着是访问控制列表条目（u：rslsync：rwx）。
</p>

<p>
如果您看到此错误：
</p>

<p>
sudo: setfacl: command not found
</p>

<p>
然后安装acl包并重新运行上面的setfacl命令：
</p>

<p>
sudo apt install acl
</p>

<p>
现在应该可以将主文件夹添加为共享文件夹。
</p>

<p>
添加文件夹后，可以通过链接，密钥或QR代码共享此文件夹：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
如果共享文件夹很大，则Resilio Sync需要一些时间来索引内容。
</p>

<p>
2、从其他设备接收文件夹
</p>

<p>
要从其他设备接收文件夹，请单击左上角的+按钮，然后选择“输入密钥或链接”：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
然后输入密钥或链接：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>



<p>
在Ubuntu 18.04,18.10服务器上使用Resilio Sync
</p>

<p>
你可以从上面提到的存储库在Ubuntu 18.04、18.10服务器上安装Resilio Sync，如果你的服务器位于云中，则需要设置反向代理才能访问Web UI，因为Web UI仅侦听本地主机，配置反向代理后，可以通过域名访问Web UI。
</p>

<p>
1、使用Nginx设置Resilio Sync反向代理
</p>

<p>
如今，Nginx作为Web服务器和反向代理变得越来越流行，使用以下命令在Ubuntu 18.04、18.10服务器上安装Nginx：
</p>

<p>
sudo apt install nginx
</p>

<p>
参考：在Ubuntu 18.04 Server中安装LEMP的方法[Nginx、MariaDB、PHP7.2]。
</p>

<p>
启动Nginx并启用自动启动：
</p>

<p>
sudo systemctl start nginx
</p>

<p>
sudo systemctl enable nginx
</p>

<p>
现在为Resilio Sync创建一个主机文件：
</p>

<p>
sudo nano /etc/nginx/conf.d/resilio-sync.conf
</p>

<p>
将以下行复制并粘贴到该文件中，将resilio.example.com替换为你的真实域名，还应该为此子域添加DNS A记录：
</p>

<p>
server {
</p>

<p>
listen 80;
</p>

<p>
server<sub>name</sub> resilio.example.com;
</p>

<p>
access<sub>log</sub> /var/log/nginx/resilio<sub>access.log</sub>;
</p>

<p>
error<sub>log</sub> /var/log/nginx/resilio<sub>error.log</sub>;
</p>

<p>
location / {
</p>

<p>
proxy<sub>pass</sub> <a href="http://127.0.0.1:8888">http://127.0.0.1:8888</a>;
</p>

<p>
proxy<sub>set</sub><sub>header</sub> Host $host;
</p>

<p>
proxy<sub>set</sub><sub>header</sub> X-Real-IP $remote<sub>addr</sub>;
</p>

<p>
proxy<sub>set</sub><sub>header</sub> X-Forwarded-For $proxy<sub>add</sub><sub>x</sub><sub>forwarded</sub><sub>for</sub>;
</p>

<p>
}
</p>

<p>
}
</p>

<p>
保存并关闭此文件，然后测试Nginx配置：
</p>

<p>
sudo nginx -t
</p>

<p>
如果测试成功，请重新加载Nginx：
</p>

<p>
sudo systemctl reload nginx
</p>

<p>
现在，在你的浏览器地址栏中输入resilio.example.com，应该能够访问到Web GUI了。
</p>

<p>
2、使用Apache设置Resilio Sync反向代理
</p>

<p>
Apache是​​众所周知的Web服务器，也可以用作反向代理，如果你更喜欢Apache到Nginx，请在Ubuntu 18.04、18.10服务器上安装它：
</p>

<p>
sudo apt install apache2
</p>

<p>
参考：在Ubuntu 18.04服务器上安装LAMP Stack的方法[Apache、MySQL、PHP]。
</p>

<p>
启动Apache并启用自动启动：
</p>

<p>
sudo systemctl start apache2
</p>

<p>
sudo systemctl enable apache2
</p>

<p>
要将Apache用作反向代理，我们需要启用代理模块和头模块：
</p>

<p>
sudo a2enmod proxy proxy<sub>http</sub> headers proxy<sub>wstunnel</sub>
</p>

<p>
现在为Resilio Sync创建一个主机文件：
</p>

<p>
sudo nano /etc/apache2/sites-available/resilio-sync.conf
</p>

<p>
将以下行复制并粘贴到该文件中，将resilio.example.com替换为你的真实域名，还应该为此子域添加DNS A记录：
</p>

<p>
&lt;VirtualHost *:80&gt;
</p>

<p>
ServerName resilio.example.com
</p>

<p>
ErrorDocument 404 /404.html
</p>

<p>
ProxyPass / <a href="http://localhost:8888/">http://localhost:8888/</a>
</p>

<p>
ProxyPassReverse / <a href="http://localhost:8888/">http://localhost:8888/</a>
</p>

<p>
ErrorLog ${APACHE<sub>LOG</sub><sub>DIR</sub>}/resilio<sub>error.log</sub>
</p>

<p>
CustomLog ${APACHE<sub>LOG</sub><sub>DIR</sub>}/resilio<sub>access.log</sub> combined
</p>

<p>
&lt;/VirtualHost&gt;
</p>

<p>
保存并关闭文件，然后启用此主机：
</p>

<p>
sudo a2ensite resilio-sync.conf
</p>

<p>
重启Apache：
</p>

<p>
sudo systemctl restart apache2
</p>

<p>
现在，你可以通过resilio.example.com访问Web UI了。
</p>



<p>
使用HTTPS保护Resilio Sync Web GUI
</p>

<p>
要在通过域名访问Resilio Sync Web UI时加密HTTP流量，我们可以通过安装从Let's Encrypt发出的免费TLS证书来启用HTTPS，运行以下命令在Ubuntu 18.04、18.10服务器上安装Let的加密客户端（certbot）：
</p>

<p>
sudo apt install certbot
</p>

<p>
如果你使用Nginx，那么你还需要安装Certbot Nginx插件：
</p>

<p>
sudo apt install python3-certbot-nginx
</p>

<p>
接下来，运行以下命令以获取并安装TLS证书：
</p>

<p>
sudo certbot &#x2013;nginx &#x2013;agree-tos &#x2013;redirect &#x2013;hsts &#x2013;staple-ocsp &#x2013;email you@example.com -d resilio.example.com
</p>

<p>
如果使用Apache，请安装Certbot Apache插件：
</p>

<p>
sudo apt install python3-certbot-apache
</p>

<p>
并运行此命令以获取并安装TLS证书：
</p>

<p>
sudo certbot &#x2013;apache &#x2013;agree-tos &#x2013;redirect &#x2013;hsts &#x2013;staple-ocsp &#x2013;email you@example.com -d resilio.example.com
</p>

<p>
说明：
</p>

<p>
&#x2013;nginx：使用nginx插件。
</p>

<p>
&#x2013;apache：使用Apache插件。
</p>

<p>
&#x2013;agree-tos：同意服务条款。
</p>

<p>
&#x2013;redirect：通过301重定向强制HTTPS。
</p>

<p>
&#x2013;hsts：将Strict-Transport-Security标头添加到每个HTTP响应中，强制浏览器始终对域使用TLS，防御SSL/TLS剥离。
</p>

<p>
&#x2013;staple-ocsp：启用OCSP Stapling，将有效的OCSP响应装订到服务器在TLS期间提供的证书。
</p>

<p>
现在应该获取并自动安装证书：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
你可以通过HTTPS（<a href="https://resilio.example.com）访问resilio">https://resilio.example.com）访问resilio</a> Sync Web UI。
</p>



<p>
在防火墙中打开Resilio Sync端口
</p>

<p>
除了Web UI端口之外，Resilio Sync还需要侦听公共接口以连接到对等端，每个设备的侦听端口都不同，可以通过转到Preference-&gt;Advanced在Resilio Sync Web UI中找到它：
</p>

<p>
在Ubuntu 18.04/18.10上安装Resilio Sync（BTSync）的方法
</p>

<p>
如果你在Ubuntu服务器上启用了UFW防火墙（参考：Debian、Ubuntu、Linux Mint系统中的UFW防火墙入门教程），则需要打开此端口，例如，我的端口是22251，所以我运行以下命令来打开它：
</p>

<p>
sudo ufw allow 22251
</p>



<p>
结语
</p>

<p>
上面的教程能够帮助你在Ubuntu 18.04、Ubuntu 18.10系统上安装Resilio Sync，安装成功后就可以在Ubuntu桌面、Ubuntu服务器和iPhone之间同步文件了。
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-164487790-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-164487790-1'); </script>
</div>
</body>
</html>
